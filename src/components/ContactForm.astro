---
// Componente de formulario de contacto con EmailJS
---

<section class="contact-form-section w-full max-w-2xl mx-auto">
  <div class="form-container">
    <div class="form-header text-center mb-8">
      <h2 class="text-3xl font-bold text-white mb-3">ðŸ“¬ EnvÃ­ame un Mensaje</h2>
      <p class="text-slate-300">
        Â¿Tienes alguna pregunta o propuesta? Â¡Me encantarÃ­a escucharte!
      </p>
    </div>

    <form id="contact-form" class="space-y-6">
      <!-- Nombre -->
      <div class="form-group">
        <label for="user_name" class="form-label">
          <span class="label-text">Nombre</span>
          <span class="text-red-400">*</span>
        </label>
        <input
          type="text"
          id="user_name"
          name="user_name"
          required
          placeholder="Tu nombre completo"
          class="form-input"
        />
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="user_email" class="form-label">
          <span class="label-text">Email</span>
          <span class="text-red-400">*</span>
        </label>
        <input
          type="email"
          id="user_email"
          name="user_email"
          required
          placeholder="tu@email.com"
          class="form-input"
        />
      </div>

      <!-- Asunto -->
      <div class="form-group">
        <label for="subject" class="form-label">
          <span class="label-text">Asunto</span>
          <span class="text-red-400">*</span>
        </label>
        <input
          type="text"
          id="subject"
          name="subject"
          required
          placeholder="Â¿De quÃ© quieres hablar?"
          class="form-input"
        />
      </div>

      <!-- Mensaje -->
      <div class="form-group">
        <label for="message" class="form-label">
          <span class="label-text">Mensaje</span>
          <span class="text-red-400">*</span>
        </label>
        <textarea
          id="message"
          name="message"
          required
          rows="6"
          placeholder="Escribe tu mensaje aquÃ­..."
          class="form-input resize-none"
        ></textarea>
      </div>

      <!-- BotÃ³n de envÃ­o -->
      <div class="form-actions">
        <button
          type="submit"
          id="submit-btn"
          class="submit-button"
        >
          <span id="button-text">
            <svg class="inline w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
            </svg>
            Enviar Mensaje
          </span>
          <span id="loading-text" class="hidden">
            <svg class="inline w-5 h-5 mr-2 animate-spin" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Enviando...
          </span>
        </button>
      </div>

      <!-- Mensajes de estado -->
      <div id="success-message" class="hidden success-message">
        <svg class="inline w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Â¡Mensaje enviado con Ã©xito! Te responderÃ© pronto.
      </div>

      <div id="error-message" class="hidden error-message">
        <svg class="inline w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <span id="error-text">Hubo un error al enviar el mensaje. Por favor, intenta de nuevo.</span>
      </div>
    </form>

    <!-- InformaciÃ³n adicional -->
    <div class="mt-8 p-6 bg-blue-900/20 border border-blue-500/30 rounded-xl">
      <p class="text-slate-300 text-sm text-center">
        ðŸ’¡ <strong>Tip:</strong> TambiÃ©n puedes contactarme directamente en 
        <a href="mailto:alesanchezpov@gmail.com" class="text-blue-400 hover:text-blue-300 font-semibold">
          alesanchezpov@gmail.com
        </a>
      </p>
    </div>
  </div>
</section>

<script>
  import emailjs from '@emailjs/browser';

  // ConfiguraciÃ³n de EmailJS
  // IMPORTANTE: Reemplaza estos valores con tus credenciales de EmailJS
  const PUBLIC_KEY = 'YOUR_PUBLIC_KEY'; // Tu Public Key de EmailJS
  const SERVICE_ID = 'YOUR_SERVICE_ID'; // Tu Service ID
  const TEMPLATE_ID = 'YOUR_TEMPLATE_ID'; // Tu Template ID

  // Inicializar EmailJS
  emailjs.init(PUBLIC_KEY);

  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
  const buttonText = document.getElementById('button-text') as HTMLElement;
  const loadingText = document.getElementById('loading-text') as HTMLElement;
  const successMessage = document.getElementById('success-message') as HTMLElement;
  const errorMessage = document.getElementById('error-message') as HTMLElement;
  const errorText = document.getElementById('error-text') as HTMLElement;

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();

    // Ocultar mensajes previos
    successMessage?.classList.add('hidden');
    errorMessage?.classList.add('hidden');

    // Mostrar estado de carga
    submitBtn.disabled = true;
    buttonText?.classList.add('hidden');
    loadingText?.classList.remove('hidden');

    try {
      // Enviar email usando EmailJS
      const result = await emailjs.sendForm(SERVICE_ID, TEMPLATE_ID, form);
      
      console.log('Email enviado:', result);

      // Mostrar mensaje de Ã©xito
      successMessage?.classList.remove('hidden');
      
      // Limpiar el formulario
      form.reset();

      // Ocultar mensaje de Ã©xito despuÃ©s de 5 segundos
      setTimeout(() => {
        successMessage?.classList.add('hidden');
      }, 5000);

    } catch (error) {
      console.error('Error al enviar email:', error);
      
      // Mostrar mensaje de error
      errorMessage?.classList.remove('hidden');
      if (error instanceof Error) {
        errorText.textContent = `Error: ${error.message}`;
      }

      // Ocultar mensaje de error despuÃ©s de 5 segundos
      setTimeout(() => {
        errorMessage?.classList.add('hidden');
      }, 5000);

    } finally {
      // Restaurar botÃ³n
      submitBtn.disabled = false;
      buttonText?.classList.remove('hidden');
      loadingText?.classList.add('hidden');
    }
  });
</script>

<style>
  .contact-form-section {
    padding: 2rem 1rem;
  }

  .form-container {
    background: linear-gradient(135deg, rgba(30, 41, 59, 0.5) 0%, rgba(51, 65, 85, 0.5) 100%);
    border: 1px solid rgba(59, 130, 246, 0.2);
    border-radius: 1.5rem;
    padding: 2.5rem;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-label {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #e2e8f0;
    font-size: 0.95rem;
  }

  .label-text {
    color: #cbd5e1;
  }

  .form-input {
    width: 100%;
    padding: 0.875rem 1.25rem;
    background: rgba(15, 23, 42, 0.6);
    border: 2px solid rgba(71, 85, 105, 0.5);
    border-radius: 0.75rem;
    color: #f1f5f9;
    font-size: 1rem;
    transition: all 0.3s ease;
    outline: none;
  }

  .form-input::placeholder {
    color: #64748b;
  }

  .form-input:focus {
    border-color: #3b82f6;
    background: rgba(15, 23, 42, 0.8);
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  }

  .form-input:hover {
    border-color: rgba(100, 116, 139, 0.7);
  }

  .submit-button {
    width: 100%;
    padding: 1rem 2rem;
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    border: none;
    border-radius: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
  }

  .submit-button:hover:not(:disabled) {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
  }

  .submit-button:active:not(:disabled) {
    transform: translateY(0);
  }

  .submit-button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .success-message {
    padding: 1rem 1.5rem;
    background: rgba(34, 197, 94, 0.1);
    border: 2px solid rgba(34, 197, 94, 0.3);
    border-radius: 0.75rem;
    color: #86efac;
    font-weight: 500;
    text-align: center;
    animation: slideIn 0.3s ease;
  }

  .error-message {
    padding: 1rem 1.5rem;
    background: rgba(239, 68, 68, 0.1);
    border: 2px solid rgba(239, 68, 68, 0.3);
    border-radius: 0.75rem;
    color: #fca5a5;
    font-weight: 500;
    text-align: center;
    animation: slideIn 0.3s ease;
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (max-width: 640px) {
    .form-container {
      padding: 1.5rem;
    }
  }
</style>
