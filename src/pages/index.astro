---
import Layout from "../layouts/Layout.astro";
import BlogContainer from "../components/BlogContainer.astro";
import MusicScienceSection from "../components/MusicScienceSection.astro";
import SignatureIdentity from "../components/SignatureIdentity.astro";
import OpenResearcherCTA from "../components/OpenResearcherCTA.astro";
import { getCollection } from 'astro:content';
import ProjectItem from '../components/ProjectItem.astro';

// Obtener proyectos para mostrar en la home (solo 3 principales)
const allProjects = await getCollection('Projects');
const sortedProjects = allProjects.sort((a, b) => {
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  return new Date(b.data.startDate).getTime() - new Date(a.data.startDate).getTime();
});
const featuredProjects = sortedProjects.slice(0, 3);

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout>
  <main>
    <div class="main-wrapper px-4">
      <section
        class="flex flex-col md:flex-row items-center gap-8 w-full lg:w-[900px] mx-auto py-32"
      >
        <img
          class="rounded-full w-40 h-40 md:w-48 md:h-48 object-cover border-4 border-blue-500/30 shadow-2xl"
          src="Photos/Foto_Profesional_Squared.jpg"
          alt="Alejandro's Logo"
        />
        <div class="Home-Introduction text-center md:text-left">
          <h1 class="text-white font-bold text-4xl md:text-5xl mb-4">
            Hola, Aquí Alejandro Sánchez
          </h1>
          <h2 class="text-slate-300 text-lg md:text-xl leading-relaxed mb-4">
            Actualmente me estoy formando como Científico de la Computación en
            la
            <a href="https://unal.edu.co/" class="text-blue-400 hover:text-blue-300 font-semibold">
              Universidad Nacional de Colombia - UNAL
            </a>. Mi interés se encuentra en la intersección del emprendimiento
            con los mundos de tecnología y arte, particularmente:
          </h2>
          <ul class="list-disc ml-6 text-slate-300 space-y-2">
            <li>
              La música ( <a
                href="https://github.com/facebookresearch/audiocraft"
                class="text-blue-400 hover:text-blue-300"
                >Generación de audio</a
              > )
            </li>
            <li>
              El aprendizaje de idiomas asiáticos: japonés y chino ( NLP - <a
                href="https://github.com/taishi-i/nagisa"
                class="text-blue-400 hover:text-blue-300"
              >
                Nagisa
              </a> )
            </li>
          </ul>
          <p class="text-slate-300 mt-4">
            ¿Prefieres hablar directamente? <a href="/contact" class="text-amber-400 hover:text-amber-300 font-semibold">Contáctame aquí</a> y te responderé lo antes posible.
          </p>
        </div>
      </section>

      <!-- Signature Identity Component -->
      <SignatureIdentity />
      
      <!-- Sección de proyectos destacados -->
      <section class="w-full lg:w-[900px] mx-auto py-12">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold text-white">✨ Proyectos Destacados</h2>
          <a 
            href="/projects" 
            class="text-blue-400 hover:text-blue-300 font-medium flex items-center gap-2"
          >
            Ver todos
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </a>
        </div>
        <!-- Mostrar 3 tarjetas destacadas en la home y un pequeño indicador 'Más' a la derecha -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-start py-6">
          <div class="md:col-span-3 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 home-projects">
            {featuredProjects.map((project) => (
              <div class="project-item">
                <ProjectItem project={project} />
              </div>
            ))}
          </div>
        </div>
      </section>

      <style>
        /* Ajustes solo para la sección de proyectos en la home: miniaturas más pequeñas */
        .home-projects .project-thumbnail img {
          height: 10rem; /* 10rem = 160px (equivalente a h-40) */
          object-fit: cover;
        }

        /* Asegurar que las tarjetas no sean demasiado altas en home */
        .home-projects .project-card {
          max-height: 18.5rem; /* limita la altura total de la tarjeta en home */
        }

        .home-projects .project-content {
          gap: 0.5rem;
        }
      </style>

      <!-- Music & Science Section -->
      <MusicScienceSection />
      
      <!-- Open Researcher CTA -->
      <OpenResearcherCTA />
      
      <BlogContainer />
    </div>
  </main>
</Layout>
